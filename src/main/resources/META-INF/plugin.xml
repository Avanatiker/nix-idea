<idea-plugin xmlns:xi="http://www.w3.org/2001/XInclude">

    <id>nix-idea</id>
    <name>NixIDEA</name>
    <vendor>NixOS</vendor>

    <depends>com.intellij.modules.lang</depends>
    <depends>com.intellij.modules.platform</depends>

    <xi:include href="/META-INF/nix-idea-lsp.xml"/>

    <extensions defaultExtensionNs="com.intellij">

        <fileType
                name="Nix file"
                implementationClass="org.nixos.idea.file.NixFileType"
                fieldName="INSTANCE"
                language="Nix"
                extensions="nix" />

        <lang.parserDefinition
                language="Nix"
                implementationClass="org.nixos.idea.lang.NixParserDefinition" />

        <lang.syntaxHighlighterFactory
                language="Nix"
                implementationClass="org.nixos.idea.lang.highlighter.NixSyntaxHighlighterFactory" />

        <highlightVisitor implementation="org.nixos.idea.lang.highlighter.NixHighlightVisitor" />
        <highlightVisitor implementation="org.nixos.idea.lang.highlighter.NixRainbowVisitor" />

        <additionalTextAttributes scheme="Default" file="org/nixos/idea/colorSchemes/NixDefault.xml"/>
        <additionalTextAttributes scheme="Darcula" file="org/nixos/idea/colorSchemes/NixDarcula.xml"/>

        <lang.braceMatcher
                language="Nix"
                implementationClass="org.nixos.idea.lang.NixBraceMatcher" />

        <lang.commenter
                language="Nix"
                implementationClass="org.nixos.idea.lang.NixCommenter"/>

        <projectConfigurable
                groupId="build"
                displayName="NixIDEA Settings"
                id="org.nixos.idea.settings.NixIDEASettings"
                instance="org.nixos.idea.settings.NixIDEASettings" />

        <colorSettingsPage
                implementation="org.nixos.idea.settings.NixColorSettingsPage" />

        <!-- <platform.lsp.serverSupportProvider
                implementation="org.nixos.idea.lsp.NixLspServerSupportProvider"/> -->

    </extensions>

</idea-plugin>
